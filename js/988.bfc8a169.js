"use strict";(self["webpackChunkcarwash_adminpanel"]=self["webpackChunkcarwash_adminpanel"]||[]).push([[988],{3148:function(t,e,a){a.r(e),a.d(e,{default:function(){return E}});var s=a(376),r=a(4064),i=a(8776),o=a(4488),n=a(3796),c=a(820),l=a(5660),d=a(5860),u=a(8792),h=a(1960),m=a(7284),p=a(8500),f=function(){var t=this,e=t._self._c;return e(n.c,{attrs:{id:"staff-profile",fluid:"",tag:"section"}},[e(m.c,{attrs:{justify:"center"}},[e(o.c,{attrs:{cols:"12",md:"4"}},[t.isUpdate?t._e():e("base-material-card",{scopedSlots:t._u([{key:"heading",fn:function(){return[e("div",{staticClass:"display-2 font-weight-light"},[t._v("Profile")])]},proxy:!0}],null,!1,2854716668)},[e(i.c$,{staticClass:"text-left"},[e("h6",{staticClass:"display-2 font-weight-black mb-1 black--text"},[t._v(" "+t._s(t.userData.name)+" ")]),e("h4",{staticClass:"display-2 font-weight-light mb-3 black--text"},[t._v(" "+t._s(t.userData.role)+" ")]),e("h6",{staticClass:"display-1 mb-1 grey--text"},[t._v(" "+t._s(t.userData.email)+" ")]),e("h6",{staticClass:"display-1 mb-1 grey--text"},[t._v(" "+t._s(t.userData.phone)+" ")]),e(s.c,{staticClass:"mr-0 mt-3",attrs:{color:"success",rounded:"",small:"",outlined:""},on:{click:function(e){t.isUpdate=!t.isUpdate}}},[e(u.c,[t._v("mdi-square-edit-outline")]),t._v(" Edit Profile ")],1)],1)],1),t.isUpdate?e("base-material-card",{scopedSlots:t._u([{key:"heading",fn:function(){return[e("div",{staticClass:"display-2 font-weight-light"},[t._v("Edit Profile")]),e("div",{staticClass:"subtitle-1 font-weight-light"},[t._v(" Complete your profile ")])]},proxy:!0}],null,!1,2582319464)},[e(d.c,[e(n.c,{staticClass:"py-0"},[e(m.c,[e(o.c,{attrs:{cols:"12",md:"6"}},[e(p.c,{staticClass:"purple-input",attrs:{label:"User Name"},model:{value:t.userData.name,callback:function(e){t.$set(t.userData,"name",e)},expression:"userData.name"}})],1),e(o.c,{attrs:{cols:"12",md:"6"}},[e(p.c,{staticClass:"purple-input",attrs:{label:"Email Address"},model:{value:t.userData.email,callback:function(e){t.$set(t.userData,"email",e)},expression:"userData.email"}})],1),e(o.c,{attrs:{cols:"12",md:"6"}},[e(p.c,{staticClass:"purple-input",attrs:{label:"Phone",type:"number"},model:{value:t.userData.phone,callback:function(e){t.$set(t.userData,"phone",e)},expression:"userData.phone"}})],1),e(o.c,{attrs:{cols:"12",md:"6"}},[e(p.c,{staticClass:"purple-input",attrs:{label:"New Password",type:"password"},model:{value:t.newPassword,callback:function(e){t.newPassword=e},expression:"newPassword"}})],1),e(o.c,{staticClass:"text-right",attrs:{cols:"12"}},[e(s.c,{staticClass:"mr-2",attrs:{color:"error"},on:{click:function(e){t.isUpdate=!t.isUpdate}}},[t._v(" Cancel ")]),e(s.c,{staticClass:"mr-0",attrs:{color:"primary"},on:{click:t.updateCustomer}},[t._v(" Update Profile ")])],1)],1)],1)],1)],1):t._e(),e("base-material-card",{scopedSlots:t._u([{key:"heading",fn:function(){return[e("div",{staticClass:"display-2 font-weight-light"},[t._v("Today Washes")])]},proxy:!0}])},[e(i.c$,{staticClass:"text-center"},[e(r.c,[e(m.c,{staticClass:"font-weight-bold"},[e(o.c,[t._v("Vehicle Number")]),e(o.c,[t._v("Type")]),e(o.c,[t._v("Time")])],1)],1),t._l(t.todayWashes,(function(a,s){return e(r.c,{key:s},[e(m.c,[e(o.c,[t._v(t._s(a?.vehicle?.vehicleNumber))]),e(o.c,[t._v(t._s(a?.washType))]),e(o.c,[t._v(t._s(t.getWashTime(a.washDate)))])],1)],1)}))],2)],1)],1),e(o.c,{attrs:{cols:"12",md:"8"}},[e("base-material-card",{scopedSlots:t._u([{key:"heading",fn:function(){return[e("div",{staticClass:"display-2 font-weight-light"},[t._v("Wash History")]),e("div",{staticClass:"subtitle-1 font-weight-light"},[t._v(" Total Completed Washes ")])]},proxy:!0}])},[e(m.c,[e(o.c,{staticClass:"d-flex justify-end",attrs:{cols:"12",md:"12"}},[e(s.c,{attrs:{small:"",color:"primary"},on:{click:t.exportToPDF}},[e(u.c,{staticClass:"mr-1"},[t._v("mdi-file-download-outline")]),t._v("Export to PDF")],1),e(s.c,{attrs:{small:"",color:"primary"},on:{click:t.exportToExcel}},[e(u.c,{staticClass:"mr-1"},[t._v("mdi-file-download-outline")]),t._v("Export to Excel")],1)],1)],1),e(m.c,[e(o.c,{attrs:{cols:"12",md:"4"}},[e(p.c,{attrs:{placeholder:"Search Vehicle...","append-icon":"mdi-magnify",clearable:"",dense:"",solo:""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),e(o.c,{attrs:{cols:"12",md:"4"}},[e(h.c,{attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","max-width":"290px"},scopedSlots:t._u([{key:"activator",fn:function({on:a}){return[e(p.c,t._g({attrs:{label:"Start Date",readonly:"",solo:"",dense:"","append-icon":"mdi-calendar"},model:{value:t.formattedStartDate,callback:function(e){t.formattedStartDate=e},expression:"formattedStartDate"}},a))]}}]),model:{value:t.menuStart,callback:function(e){t.menuStart=e},expression:"menuStart"}},[e(l.c,{attrs:{scrollable:""},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}})],1)],1),e(o.c,{attrs:{cols:"12",md:"4"}},[e(h.c,{attrs:{"close-on-content-click":!1,transition:"scale-transition","offset-y":"","max-width":"290px"},scopedSlots:t._u([{key:"activator",fn:function({on:a}){return[e(p.c,t._g({attrs:{solo:"",label:"End Date",readonly:"",dense:"","append-icon":"mdi-calendar"},model:{value:t.formattedEndtDate,callback:function(e){t.formattedEndtDate=e},expression:"formattedEndtDate"}},a))]}}]),model:{value:t.menuEnd,callback:function(e){t.menuEnd=e},expression:"menuEnd"}},[e(l.c,{attrs:{scrollable:""},model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}})],1)],1)],1),e(c.c,{attrs:{headers:t.headers,items:t.filteredItems},scopedSlots:t._u([{key:"item._id",fn:function({item:a,index:s}){return[a?e("span",[t._v(t._s(s+1))]):t._e()]}},{key:"item.vehicle",fn:function({item:e}){return[t._v(" "+t._s(e.vehicle?.vehicleNumber)+" ")]}},{key:"item.type",fn:function({item:e}){return[t._v(" "+t._s(e.vehicle?.type)+" ")]}},{key:"item.time",fn:function({item:e}){return[t._v(" "+t._s(t.getWashTime(e.washDate))+" ")]}},{key:"item.date",fn:function({item:e}){return[t._v(" "+t._s(t.getDate(e.washDate))+" ")]}},{key:"item.action",fn:function({item:a}){return[e(s.c,{attrs:{color:"success"},on:{click:function(e){return t.viewDetails(a._id)}}},[t._v("view")]),e(s.c,{attrs:{color:"red"}},[t._v("Delete")])]}}],null,!0)})],1)],1)],1)],1)},v=[],D=a(7412),_=a.n(D),w=a(2774),y=a(5948),g=(a(8200),a(1532)),b={data(){return{headers:[{text:"ID",value:"_id"},{text:"Vehicle",value:"vehicle"},{text:"Car  Type",value:"type"},{text:"Wash Date",value:"date"},{text:"Wash Time",value:"time"}],userData:[],todayWashes:[],washHistory:[],isUpdate:!1,newPassword:"",search:"",startDate:null,endDate:null,menuStart:!1,menuEnd:!1}},created(){this.fetchUserData(),this.fetchTodayData(),this.fetchTotalData()},computed:{filteredItems(){let t=this.washHistory;if(this.search){const e=this.search.toLowerCase();t=t.filter((t=>Object.values(t).some((t=>"object"===typeof t&&null!==t?Object.values(t).some((t=>"string"===typeof t&&t.toLowerCase().includes(e))):"string"===typeof t&&t.toLowerCase().includes(e)))))}if(this.startDate&&this.endDate){const e=new Date(this.startDate),a=new Date(this.endDate);t=t.filter((t=>{const s=new Date(t.washDate);return s>=e&&s<=a}))}return t},formattedStartDate(){return this.startDate?this.getDate(this.startDate):""},formattedEndDate(){return this.endDate?this.getDate(this.endDate):""}},methods:{async updateCustomer(){try{this.newPassword&&(this.userData.password=this.newPassword);const t=await w.c.post(`/update/${this.userData._id}`,this.userData);if(!t.status)throw new Error(`Failed to update user: ${t.statusText}`);const e=t.data;this.isUpdate=!this.isUpdate,console.log(e),this.fetchData()}catch(t){console.error("Error updating user:",t)}},async fetchUserData(){try{const t=this.$route.params.id,e=await w.c.post("/getuser",{id:t});if(!e.status)throw new Error("Failed to fetch user data");this.userData=e.data.user}catch(t){console.error("Error fetching user data:",t)}},async fetchTodayData(){try{const t=this.$route.params.id,e=await w.c.post(`/today-washes/${t}`,{headers:{"Content-Type":"application/json"}});if(!e)throw new Error("Failed to fetch user data");this.todayWashes=e.data.data}catch(t){console.error("Error fetching user data:",t)}},async fetchTotalData(){try{const t=this.$route.params.id,e=await w.c.post(`/get-washes/${t}`,{headers:{"Content-Type":"application/json"}});if(!e.status)throw new Error("Failed to fetch user data");this.washHistory=e.data.data}catch(t){console.error("Error fetching user data:",t)}},getWashTime(t){return _()(t).format("h:mm A")},getDate(t){return _()(t).format("Do MMM YYYY")},exportToPDF(){const t=new y.jsPDF,e=this.headers.map((t=>t.text)),a=this.filteredItems.map(((t,e)=>{const a=this.getDate(t.washDate),s=this.getWashTime(t.washDate);return[e+1,t.vehicle.vehicleNumber,t.vehicle.type,a,s]}));t.setFontSize(16),t.text("Car Wash Details of "+this.userData.name+this.getDate(new Date),10,10),t.autoTable({head:[e],body:a}),t.save(this.userData.name+"_"+this.getDate(new Date)+".pdf")},exportToExcel(){const t=this.headers.map((t=>t.text)),e=this.filteredItems.map(((t,e)=>{const a=this.getDate(t.washDate),s=this.getWashTime(t.washDate);return[e+1,t.vehicle.vehicleNumber,t.vehicle.type,a,s]})),a=g.c$.aoa_to_sheet([t,...e]),s=g.c$.book_new();g.c$.book_append_sheet(s,a,"Sheet1"),g.a8(s,this.userData.name+"_"+this.getDate(new Date)+".xlsx")}}},x=b,k=a(2528),C=(0,k.c)(x,f,v,!1,null,null,null),E=C.exports},5860:function(t,e,a){a(3248);var s=a(2752),r=a(8300),i=a(8789);e.c=(0,s.c)(r.c,(0,i.Z)("form")).extend({name:"v-form",provide(){return{form:this}},inheritAttrs:!1,props:{disabled:Boolean,lazyValidation:Boolean,readonly:Boolean,value:Boolean},data:()=>({inputs:[],watchers:[],errorBag:{}}),watch:{errorBag:{handler(t){const e=Object.values(t).includes(!0);this.$emit("input",!e)},deep:!0,immediate:!0}},methods:{watchInput(t){const e=t=>t.$watch("hasError",(e=>{this.$set(this.errorBag,t._uid,e)}),{immediate:!0}),a={_uid:t._uid,valid:()=>{},shouldValidate:()=>{}};return this.lazyValidation?a.shouldValidate=t.$watch("shouldValidate",(s=>{s&&(this.errorBag.hasOwnProperty(t._uid)||(a.valid=e(t)))})):a.valid=e(t),a},validate(){return 0===this.inputs.filter((t=>!t.validate(!0))).length},reset(){this.inputs.forEach((t=>t.reset())),this.resetErrorBag()},resetErrorBag(){this.lazyValidation&&setTimeout((()=>{this.errorBag={}}),0)},resetValidation(){this.inputs.forEach((t=>t.resetValidation())),this.resetErrorBag()},register(t){this.inputs.push(t),this.watchers.push(this.watchInput(t))},unregister(t){const e=this.inputs.find((e=>e._uid===t._uid));if(!e)return;const a=this.watchers.find((t=>t._uid===e._uid));a&&(a.valid(),a.shouldValidate()),this.watchers=this.watchers.filter((t=>t._uid!==e._uid)),this.inputs=this.inputs.filter((t=>t._uid!==e._uid)),this.$delete(this.errorBag,e._uid)}},render(t){return t("form",{staticClass:"v-form",attrs:{novalidate:!0,...this.attrs$},on:{submit:t=>this.$emit("submit",t)}},this.$slots.default)}})}}]);
//# sourceMappingURL=988.bfc8a169.js.map