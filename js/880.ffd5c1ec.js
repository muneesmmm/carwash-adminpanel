"use strict";(self["webpackChunkcarwash_adminpanel"]=self["webpackChunkcarwash_adminpanel"]||[]).push([[880],{9628:function(t,e,a){a.r(e),a.d(e,{default:function(){return k}});var s=a(376),o=a(4488),r=a(3796),n=a(820),c=a(5660),i=a(8792),l=a(1960),d=a(7284),h=a(8500),u=function(){var t=this,e=t._self._c;return e(r.c,{attrs:{id:"wash",fluid:"",tag:"section"}},[e(d.c,[e(o.c,{attrs:{cols:"12",md:"3"}},[e("router-link",{staticClass:"no-decoration",attrs:{to:{path:"/pages/customer"}}},[e("base-material-stats-card",{attrs:{color:"primary",icon:"mdi-account",title:"Total Customers",value:t.dashboard.customerCount,"sub-icon":"mdi-account","sub-text":"Total registered Customer"}})],1)],1),e(o.c,{attrs:{cols:"12",md:"3"}},[e("router-link",{staticClass:"no-decoration",attrs:{to:{path:"/pages/customer"}}},[e("base-material-stats-card",{attrs:{color:"primary",icon:"mdi-car",title:"total Vehicles",value:t.dashboard.vehicleCount,"sub-icon":"mdi-car","sub-text":"Total registered Vehicles"}})],1)],1),e(o.c,{attrs:{cols:"12",md:"3"}},[e("router-link",{staticClass:"no-decoration",attrs:{to:{path:"/pages/staff"}}},[e("base-material-stats-card",{attrs:{color:"primary",icon:"mdi-account",title:"Total Staff",value:t.dashboard.userCount-1,"sub-icon":"mdi-account","sub-text":"Total Staff"}})],1)],1),e(o.c,{attrs:{cols:"12",md:"3"}},[e("base-material-stats-card",{attrs:{color:"primary",icon:"mdi-car-wash",title:"Total Washes",value:t.dashboard.washHistoryCount,"sub-icon":"mdi-car-wash","sub-text":"Total washes"}})],1)],1),e(d.c,[e(o.c,{attrs:{cols:"12",md:"3"}},[e(h.c,{attrs:{placeholder:"Search Vehicle...","append-icon":"mdi-magnify",clearable:"","hide-details":"",dense:"",solo:""},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}})],1),e(o.c,{attrs:{cols:"12",md:"2"}},[e(l.c,{attrs:{"close-on-content-click":!0,transition:"scale-transition","offset-y":"","max-width":"290px"},scopedSlots:t._u([{key:"activator",fn:function({on:a}){return[e(h.c,t._g({staticClass:"mt-0",attrs:{label:"Start Date",readonly:"",dense:"",solo:"","hide-details":"","append-icon":"mdi-calendar"},model:{value:t.formattedStartDate,callback:function(e){t.formattedStartDate=e},expression:"formattedStartDate"}},a))]}}]),model:{value:t.menuStart,callback:function(e){t.menuStart=e},expression:"menuStart"}},[e(c.c,{attrs:{scrollable:""},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}})],1)],1),e(o.c,{attrs:{cols:"12",md:"2"}},[e(l.c,{attrs:{"close-on-content-click":!0,transition:"scale-transition","offset-y":"","max-width":"290px"},scopedSlots:t._u([{key:"activator",fn:function({on:a}){return[e(h.c,t._g({attrs:{solo:"",dense:"",label:"End Date",readonly:"","hide-details":"","append-icon":"mdi-calendar"},model:{value:t.formattedEndDate,callback:function(e){t.formattedEndDate=e},expression:"formattedEndDate"}},a))]}}]),model:{value:t.menuEnd,callback:function(e){t.menuEnd=e},expression:"menuEnd"}},[e(c.c,{attrs:{scrollable:""},model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}})],1)],1),e(o.c,{staticClass:"d-flex justify-end",attrs:{cols:"12",md:"5"}},[e(s.c,{attrs:{small:"",color:"primary"},on:{click:t.exportToPDF}},[e(i.c,{staticClass:"mr-1"},[t._v("mdi-file-download-outline")]),t._v("Export to PDF")],1),e(s.c,{attrs:{small:"",color:"primary"},on:{click:t.exportToExcel}},[e(i.c,{staticClass:"mr-1"},[t._v("mdi-file-download-outline")]),t._v("Export to Excel")],1)],1)],1),e("base-material-card",{staticClass:"px-5 py-3",attrs:{icon:"mdi-clipboard-text",title:"Manage Wash"}},[e(n.c,{attrs:{headers:t.headers,items:t.filteredItems},scopedSlots:t._u([{key:"item._id",fn:function({item:a,index:s}){return[a?e("span",[t._v(t._s(s+1))]):t._e()]}},{key:"item.washDate",fn:function({item:a}){return[a?e("span",[t._v(t._s(t.getDate(a.washDate)))]):t._e()]}}],null,!0)})],1)],1)},m=[],f=a(2774),p=a(5948),D=(a(8200),a(1532)),b=a(7412),v=a.n(b),x={name:"WashDashboard",data(){return{headers:[{text:"ID",value:"_id"},{text:"Vehicle",value:"vehicle.vehicleNumber"},{text:"Customer Name",value:"vehicle.owner.name"},{text:"Phone",value:"vehicle.owner.phone"},{text:"Staff Name",value:"staff.name"},{text:"Wash Site",value:"staff.location"},{text:"Date",value:"washDate"},{text:"Time",value:"formattedTime"}],washHistory:[],search:"",startDate:null,endDate:null,menuStart:!1,menuEnd:!1,dashboard:null}},computed:{filteredItems(){let t=this.washHistory;if(this.search){const e=this.search.toLowerCase();t=t.filter((t=>Object.values(t).some((t=>"object"===typeof t&&null!==t?Object.values(t).some((t=>"string"===typeof t&&t.toLowerCase().includes(e))):"string"===typeof t&&t.toLowerCase().includes(e)))))}if(this.startDate&&this.endDate){const e=new Date(this.startDate),a=new Date(this.endDate);t=t.filter((t=>{const s=new Date(t.washDate);return s>=e&&s<=a}))}return t},formattedStartDate(){return this.startDate?this.getDate(this.startDate):""},formattedEndDate(){return this.endDate?this.getDate(this.endDate):""}},methods:{async totalWashes(){try{const t=await f.c.post("/get-washes",{headers:{"Content-Type":"application/json"}});if(!t.status)throw new Error(`Failed to fetch data: ${t.statusText}`);this.washHistory=t.data.data}catch(t){console.error("Error fetching user data:",t)}},async dashboardData(){try{const t=await f.c.post("/dashboard-data",{headers:{"Content-Type":"application/json"}});if(!t.status)throw new Error(`Failed to fetch data: ${t.statusText}`);this.dashboard=t.data.data}catch(t){console.error("Error fetching user data:",t)}},exportToPDF(){const t=new p.jsPDF,e=this.headers.map((t=>t.text)),a=this.filteredItems.map(((t,e)=>{const a=t.staff?t.staff.name:"",s=t.vehicle?t.vehicle.owner.name:"",o=this.getDate(t.washDate);return[e+1,t.vehicle.vehicleNumber,s,t.vehicle.owner.phone,a,o,t.formattedTime]}));t.autoTable({head:[e],body:a}),t.save("exported_file.pdf")},exportToExcel(){const t=this.headers.map((t=>t.text)),e=this.filteredItems.map(((t,e)=>{const a=t.staff?t.staff.name:"",s=t.vehicle?t.vehicle.owner.name:"",o=this.getDate(t.washDate);return[e+1,t.vehicle.vehicleNumber,s,t.vehicle.owner.phone,a,o,t.formattedTime]})),a=D.c$.aoa_to_sheet([t,...e]),s=D.c$.book_new();D.c$.book_append_sheet(s,a,"Sheet1"),D.a8(s,"exported_file.xlsx")},getDate(t){return v()(t).format("Do MMM YYYY")}},mounted(){this.totalWashes(),this.dashboardData()}},w=x,y=a(2528),_=(0,y.c)(w,u,m,!1,null,null,null),k=_.exports}}]);
//# sourceMappingURL=880.ffd5c1ec.js.map